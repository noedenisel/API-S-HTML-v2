<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="Estilos apis.css">
    <title>APIs de HTML</title>
</head>
<body>
    <div  class="contenido">
        <h1> Práctica API'S de HTML</h1>
        <h2> Seleccione su archivo</h2>
        <label for="archivo"></label>
        <input type="file" class="seleccioneVideo" id="file" name="file" accept="video/*">
        <output id="video-output"></output>

        <div  class="controles">
            <button class="button" id="play" style="visibility: hidden;" onclick="document.getElementById('video').play();"> Reproducir </button>
            </button>
            <button class="button" id="pause" style="visibility: hidden;" onclick="document.getElementById('video').pause();"> Pausar </button>
            <button class="button" id="subirVolumen" style="visibility: hidden;" onclick="document.getElementById('video').volume +=0.1;"> Subir Volumen </button>
            <button class="button" id="bajarVolumen" style="visibility: hidden;" tonclick="document.getElementById('video').volume -=0.1;">Bajar Volumen</button>
        </div>
        
    </div>


        <script>
            
            if(window.File && window.FileReader && window.FileList && window.Blob) {
    function handleFileSelect(evt) {
        let file = evt.target.files[0];

        if (!file.type.match('video.*')) {
            return;
        }

        let reader = new FileReader();

        reader.onload = (function (theFile) {
            return function (e) {
                let videoDiv = document.getElementsByClassName('video-container');

                if(videoDiv[0] != null) {
                    videoDiv[0].parentNode.removeChild(videoDiv[0]);
                }
                    
                let div = document.createElement('div');
                div.id = "video-div";
                div.className = "video-container";
                div.innerHTML = '<video controls id="video" class="thumb" src="' + e.target.result + '" title="'+ escape(theFile.name) + '"/>';

                document.getElementById('video-output').insertBefore(div, null);

                let mensajeCargando = document.createElement('p');

                mensajeCargando.id = "loading";
                mensajeCargando.className = "mensaje-cargando";
                mensajeCargando.innerHTML = 'El video está cargando';

                document.getElementById('video-output').insertBefore(mensajeCargando, null);

                let playButton = document.getElementById('play');
                let pauseButton = document.getElementById('pause');
                let volumesubirVolumen = document.getElementById('subirVolumen');
                let volumebajarVolumen = document.getElementById('bajarVolumen');
                
                playButton.addEventListener('click', () => {
                    document.getElementById('video').play();
                });
                
                pauseButton.addEventListener('click', () => {
                    document.getElementById('video').pause();
                })

                volumesubirVolumen.addEventListener('click', () => {
                    document.getElementById('video').volume += 0.1;
                })

                volumebajarVolumen.addEventListener('click', () => {
                    document.getElementById('video').volume -= 0.1;
                })

                document.getElementById('video').addEventListener('canplay', () => {
                    let mensajeCargando = document.getElementById('loading');

                    document.getElementById('video-output').removeChild(mensajeCargando);

                    document.getElementById('video').style.visibility = "visible";

                    playButton.style.visibility = "visible";
                    pauseButton.style.visibility = "visible";
                    volumesubirVolumen.style.visibility = "visible";
                    volumebajarVolumen.style.visibility = "visible"; 
                });
            }
        }) (file);

        reader.readAsDataURL(file);
    } 

    document.getElementById('file').addEventListener('change', handleFileSelect, false);
} else {
    alert('File APIs no están soportadas por este navegador.')
}
        </script>
     
        
</body>
</html>
